<!DOCTYPE HTML>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Hot Reload – Ema</title><meta name="description" content="Ema static site generator (Jamstack) in Haskell"><link href="/ema.svg" rel="icon" /><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#DB2777"><link href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-tomorrow.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/combine/npm/prismjs@1.23.0/prism.min.js,npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/combine/npm/twind/twind.umd.min.js,npm/twind/observe/observe.umd.min.js"></script><script type="text/javascript">twind.setup({})
twindObserve.observe(document.documentElement)</script></head><body class="overflow-y-scroll"><div class="flex justify-center p-4 bg-pink-600 text-gray-100 font-bold text-2xl"><div><b>WIP: </b>Documentation is still being written</div></div><div class="container mx-auto xl:max-w-screen-lg"><div class="px-2 grid grid-cols-12"><div class="hidden mt-2 md:block md:col-span-3 md:sticky md:top-0 md:h-screen overflow-x-auto"><div class="pl-2 font-bold"><div class="my-2 "><a class="" href="/">Ema</a></div></div><div class="pl-2"><div class="my-2 "><a class="" href="/start">Getting Started</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="" href="/start/tutorial">Tutorial</a></div><div class="pl-2"></div></div><div class="my-2 "><a class="" href="/guide">Guide</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="" href="/guide/model">Defining your model</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/routes">Working with routes</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/class">Defining Ema instance</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/render">Rendering HTML</a></div><div class="pl-2"></div><div class="my-2 "><a class="" href="/guide/helpers">Helpers</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="" href="/guide/helpers/tailwind">Using Tailwind CSS</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/helpers/filesystem">Working with files</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/helpers/markdown">Converting Markdown</a></div><div class="pl-2"></div></div></div><div class="my-2 "><a class="" href="/concepts">Concepts</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="text-pink-600" href="/concepts/hot-reload">Hot Reload</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/lvar">LVar</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/slug">Slug</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/cli">CLI</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/logging">Logging</a></div><div class="pl-2"></div></div></div></div><div class="col-span-12 md:col-span-9"><div class="w-full text-gray-600 mt-4 block md:hidden"><div class="flex justify-center"><div class="w-full bg-white py-2 rounded"><ul class="flex text-gray-500 text-sm lg:text-base"><li class="inline-flex items-center"><a class="px-1 font-bold bg-pink-500 text-gray-50 rounded" href="/">Ema</a><svg fill="currentColor" viewBox="0 0 20 20" class="h-5 w-auto text-gray-400"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></li><li class="inline-flex items-center"><a class="px-1 font-bold bg-pink-500 text-gray-50 rounded" href="/concepts">Concepts</a><svg fill="currentColor" viewBox="0 0 20 20" class="h-5 w-auto text-gray-400"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></li><li class="inline-flex items-center text-gray-600"><a>Hot Reload</a></li></ul></div></div></div><h1 class="text-6xl mt-2 mb-2 text-center pb-2" id="hot-reload">Hot Reload</h1><p class="my-2"><strong>Hot Reloading</strong> is a feature of Ema’s dev server wherein any changes to your Haskell source or data files (such as Markdown files or HTML templates) propagate instantly to the web browser without requiring any manual intervention like a full refresh. In practice, this is a such a delightful feature to work with. Imagine changing CSS style of an element, and see it reflect on your site in a split second.</p><h2 class="text-5xl mt-4 mb-2 text-gray-700" id="how-ema-implements-hot-reload">How Ema implements hot reload</h2><h3 class="text-4xl mt-4 mb-2 text-gray-700" id="websocket">Websocket</h3><p class="my-2">The Ema dev server uses websockets to keep a bi-directional connection open between the web browser and the backend server. With you click on a link or when something changes in the backend, they are communicated via this connection. In a statically generated site, however, no such activity happens - and a link click behaves like a normal link in that the browser makes a full HTTP request to the linked page.</p><h3 class="text-4xl mt-4 mb-2 text-gray-700" id="dom-patching">DOM patching</h3><p class="my-2">When switching to a new route or when receiving the new HTML, Ema uses <a class="text-pink-600 hover:underline" href="https://github.com/patrick-steele-idem/morphdom" title="" target="_blank" rel="noopener">morphdom</a> to <em>patch</em> the existing DOM tree rather than replacing it. This, in addition to use of websockets, makes it possible to support <strong>instant</strong> hot reload with nary a delay.</p><h3 class="text-4xl mt-4 mb-2 text-gray-700" id="haskell-reload">Haskell reload</h3><p class="my-2">Finally, hot reload on <em>code</em> changes are supported via <a class="text-pink-600 hover:underline" href="https://github.com/ndmitchell/ghcid" title="" target="_blank" rel="noopener">ghcid</a>. The <a class="text-pink-600 hover:underline" href="https://github.com/srid/ema-docs" title="" target="_blank" rel="noopener">template repo</a>&#39;s `bin/run` script uses ghcid underneath. Any HTML DSL (like blaze – as used by the <a class="text-pink-600 font-bold hover:bg-pink-50" href="/guide/helpers/tailwind" title="">Tailwind helper</a>) or CSS DSL automatically gets support for hot-reload. If you choose to use a file-based HTML template language, you can enable hot-reload on template change using the <a class="text-pink-600 font-bold hover:bg-pink-50" href="/guide/helpers/filesystem" title="">FileSystem helper</a>.</p><p class="my-2">Note that if your application makes use of threads, it is important to setup cleanup handlers them so that <code>ghcid</code> doesn’t leave ghost processes behind. Helpers like <a class="text-pink-600 hover:underline" href="https://hackage.haskell.org/package/async-2.2.3/docs/Control-Concurrent-Async.html#v:race_" title="" target="_blank" rel="noopener"><code>race_</code></a> will do this automatically (incidentally it is used by <code>runEma</code> for running the user IO action).</p><h3 class="text-4xl mt-4 mb-2 text-gray-700" id="data-reload">Data reload</h3><p class="my-2">For anything outside of the Haskell code, your code becomes responsible for monitoring and update the model <a class="text-pink-600 font-bold hover:bg-pink-50" href="/concepts/lvar" title="">LVar</a>. The <a class="text-pink-600 font-bold hover:bg-pink-50" href="/guide/helpers/filesystem" title="">filesystem helper</a> already provides utilities to facilitate this for monitoring changes to files and directories.</p><h2 class="text-5xl mt-4 mb-2 text-gray-700" id="haskell-exceptions">Haskell Exceptions</h2><p class="my-2">If you code throws a Haskell exception, they will be handled and displayed in the browser.</p><footer class="mt-8 text-center text-gray-500">Powered by <a class="font-bold" target="blank" rel="noopener" href="https://github.com/srid/ema">Ema</a></footer></div></div></div></body></html>