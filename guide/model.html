<!DOCTYPE HTML>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Defining your model – Ema</title><meta name="description" content="Ema static site generator (Jamstack) in Haskell"><link href="/ema.svg" rel="icon" /><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#DB2777"><link href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-tomorrow.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/combine/npm/prismjs@1.23.0/prism.min.js,npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/combine/npm/twind/twind.umd.min.js,npm/twind/observe/observe.umd.min.js"></script><script type="text/javascript">twind.setup({})
twindObserve.observe(document.documentElement)</script></head><body class="overflow-y-scroll"><div class="flex justify-center p-4 bg-pink-600 text-gray-100 font-bold text-2xl"><div><b>WIP: </b>Documentation is nearly complete</div></div><div class="container mx-auto xl:max-w-screen-lg"><div class="px-2 grid grid-cols-12"><div class="hidden mt-2 md:block md:col-span-3 md:sticky md:top-0 md:h-screen overflow-x-auto"><div class="pl-2 font-bold"><div class="my-2 "><a class="" href="/">Ema</a></div></div><div class="pl-2"><div class="my-2 "><a class="" href="/start">Getting Started</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="" href="/start/tutorial">Tutorial</a></div><div class="pl-2"></div></div><div class="my-2 "><a class="" href="/guide">Guide</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="text-pink-600" href="/guide/model">Defining your model</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/routes">Working with routes</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/class">Defining Ema instance</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/render">Rendering HTML</a></div><div class="pl-2"></div><div class="my-2 "><a class="" href="/guide/helpers">Helpers</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="" href="/guide/helpers/tailwind">Using Tailwind CSS</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/helpers/filesystem">Working with files</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/guide/helpers/markdown">Converting Markdown</a></div><div class="pl-2"></div></div></div><div class="my-2 "><a class="" href="/concepts">Concepts</a></div><div class="pl-2"><div class="my-2 text-gray-600"><a class="" href="/concepts/hot-reload">Hot Reload</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/lvar">LVar</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/slug">Slug</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/cli">CLI</a></div><div class="pl-2"></div><div class="my-2 text-gray-600"><a class="" href="/concepts/logging">Logging</a></div><div class="pl-2"></div></div></div></div><div class="col-span-12 md:col-span-9"><div class="w-full text-gray-600 mt-4 block md:hidden"><div class="flex justify-center"><div class="w-full bg-white py-2 rounded"><ul class="flex text-gray-500 text-sm lg:text-base"><li class="inline-flex items-center"><a class="px-1 font-bold bg-pink-500 text-gray-50 rounded" href="/">Ema</a><svg fill="currentColor" viewBox="0 0 20 20" class="h-5 w-auto text-gray-400"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></li><li class="inline-flex items-center"><a class="px-1 font-bold bg-pink-500 text-gray-50 rounded" href="/guide">Guide</a><svg fill="currentColor" viewBox="0 0 20 20" class="h-5 w-auto text-gray-400"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></li><li class="inline-flex items-center text-gray-600"><a>Defining your model</a></li></ul></div></div></div><h1 class="text-6xl mt-2 mb-2 text-center pb-2" id="defining-your-model">Defining your model</h1><p class="my-2">A “<em>model</em>” in Ema represents the state to use to generate your site. It could be as simple as a variable, or it could be a list of parsed Markdown files (as in the case of a weblog). Ema’s model is also conceptually similar to <a class="text-pink-600 hover:underline" href="https://guide.elm-lang.org/architecture/" title="" target="_blank" rel="noopener">Elm</a>&#39;s model, in that - changing the model <a class="text-pink-600 font-bold hover:bg-pink-50" href="/concepts/hot-reload" title="">automatically</a> changes the <a class="text-pink-600 font-bold hover:bg-pink-50" href="/guide/render" title="">view</a>.</p><p class="my-2">Here’s an example model:</p><div class="py-0.5"><pre class="haskell language-haskell"><code class="haskell language-haskell">type Slug = Text

newtype BlogPosts = BlogPosts (Map Slug Text}</code></pre></div><p class="my-2">Here <code>BlogPosts</code> is the model type. If we are generating a weblog site, then all the “data” we need is loaded into memory as a value of <code>BlogPosts</code>.</p><h2 class="text-5xl mt-4 mb-2 text-gray-700" id="modifying-the-model">Modifying the model</h2><p class="my-2">Ema’s dev server supports <a class="text-pink-600 font-bold hover:bg-pink-50" href="/concepts/hot-reload" title="">hot reload</a>; it will observe changes to your model, in addition to code. To facilitate this you will manage your model as a <a class="text-pink-600 font-bold hover:bg-pink-50" href="/concepts/lvar" title="">LVar</a>. The <code>runEma</code> function (<a class="text-pink-600 font-bold hover:bg-pink-50" href="/guide/class" title="">described here</a>) takes an IO action that gets <code>LVar model</code> as an argument.</p><p class="my-2">For example,</p><div class="py-0.5"><pre class="haskell language-haskell"><code class="haskell language-haskell">runEma render $ \model -&gt;
  forever $ do
    LVar.set model =&lt;&lt; liftIO getCurrentTime
    liftIO $ threadDelay $ 1 * 1000000</code></pre></div><p class="my-2">In this contrived example (<a class="text-pink-600 hover:underline" href="https://github.com/srid/ema/blob/master/src/Ema/Example/Ex02_Clock.hs" title="" target="_blank" rel="noopener">full code here</a>), we are using <code>UTCTime</code> as the model. We set the initial value using <code>LVar.set</code>, and then continually update the current time every second. Every time the model gets updated, the web browser will <a class="text-pink-600 font-bold hover:bg-pink-50" href="/concepts/hot-reload" title="">hot reload</a> to display the up to date value. For the <code>BlogPosts</code> model, you would typically use <a class="text-pink-600 hover:underline" href="https://hackage.haskell.org/package/fsnotify" title="" target="_blank" rel="noopener">fsnotify</a> to monitor changes to the underlying Markdown files, but note that Ema provides <a class="text-pink-600 font-bold hover:bg-pink-50" href="/guide/helpers/filesystem" title="">a helper</a> for that.</p><div class="mt-8 border-t-2 border-pink-500 pb-1 pl-1 bg-gray-50 rounded"><p class="my-2"><span class="py-2 text-xl italic font-bold">Next</span>, we will <a class="text-pink-600 font-bold hover:bg-pink-50" href="/guide/routes" title="">talk about routes</a>.</p></div><footer class="mt-8 text-center text-gray-500">Powered by <a class="font-bold" target="blank" rel="noopener" href="https://github.com/srid/ema">Ema</a></footer></div></div></div></body></html>